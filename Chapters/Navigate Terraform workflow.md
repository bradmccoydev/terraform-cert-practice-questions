# What is the command init?

The terraform init command is used to initialize a working directory containing Terraform configuration files.

This is the first command that should be run after writing a new Terraform configuration or cloning an existing one from version control.

It is safe to run this command multiple times, to bring the working directory up to date with changes in the configuration.
 
# What is the flag you should use to upgrade modules and plugins a part of their respective installation steps?

terraform init -upgrade

Installs latest version of modules and plugins allowed within configured version constraints

# What is the flag to skip backend initialization when running terraform init?

terraform init -backend=false

# What should you do to skip child module installations when running terraform init?

terraform init -get=false

Skips downloading modules for this configuration

# What should you do to skip plugin installations when running terraform init?

terraform init -get-plugins=false

Skips plugin installation. Terraform will use plugins installed in the user plugins directory, and any plugins already installed for the current working directory. If the installed plugins aren't sufficient for the configuration, init fails.

# Where do plugins get stored when doing initialization?

On most operationg systems : ~/.terraform.d/plugins
On Windows : %APPDATA%\terraform.d\plugins

# You have started writing terraform configuration and you are using some sample configuration as a basis. How do you copy the example configuration into your working directory?

terraform init -from-module=MODULE-SOURCE

This mode of operation supports two use-cases:

Given a version control source, it can serve as a shorthand for checking out a configuration from version control and then initializing the working directory for it.

If the source refers to an example configuration, it can be copied into a local directory to be used as a basis for a new configuration.

# What does the command terraform validate do?

The terraform validate command validates the configuration files in a directory, referring only to the configuration and not accessing any remote services such as remote state, provider APIs, etc.

Validate runs checks that verify whether a configuration is syntactically valid and internally consistent, regardless of any provided variables or existing state. 

It is primarily useful for general verification of reusable modules, including correctness of attribute names and value types.

# What does the command terraform plan do?

The terraform plan command is used to create an execution plan. 

Terraform performs a refresh (unless explicitly disabled) and then determines what actions are necessary to achieve the desired state specified in the configuration files.

# What is the flag you should use with terraform plan to get details on the exit codes?

terraform plan -detailed-exitcode

Return a detailed exit code when the command exits. When provided, this argument changes the exit codes and their meanings to provide more granular information about what the resulting plan contains:

0 = Succeeded with empty diff (no changes)
1 = Error
2 = Succeeded with non-empty diff (changes present)

# How do you target only specific resources when you run a terraform plan?

terraform plan -target=resource - A Resource Address to target (eg: azurerm_storage_account.default)

How do you update the state prior to checking differences when you run a terraform plan?

terraform plan -refresh=true

# How do you save an execution plan?

terraform plan -out="plan-name"

This plan can then be used with terraform apply.

# What does the command terraform apply do?

The terraform apply command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan (eg: terraform apply “plan-name”).

# You are applying the infrastructure with the command apply and you don’t want to do interactive approval. Which flag should you use?

terraform apply -auto-approve

Useful in DevOps pipelines type scenarios where STDIN is not available.

# You created a VM instance on AWS cloud provider with the terraform configuration and you log into the AWS console and removed the instance. What does the next apply do?

It will detect that a VM instance was removed outside of Terraform, and recreates the VM instance to match the terraform configuration.
 
# You have the following file and created two resources docker_image and docker_container with the command terraform apply and you go to the terminal and delete the container with the command docker rm. You come back to your configuration and run the command again. Does terraform recreates the resource?

resource "docker_image" "nginx" {
    name = "nginx:latest"
    keep_locally = false
}

resource "docker_container" "nginx" {
    image = docker_image.nginx.latest
    name = "nginxtutorial"
    ports {
        internal = 80
        external = 8080
    }
    upload {
        source = "${abspath(path.root)}/files/index.html"
        file = "/usr/share/nginx/html/index.html"
    }
}

Yes the resource is recreated, as the execution plan states two resources will be created (docker_image & docker_container), and terraform apply will achieve that plan.

# You have the following file and created two resources docker_image and docker_container with the command terraform planand you go to the terminal and delete the container with the command docker rm. You come back to your configuration and run the command again. What is the output of the command plan?


resource "docker_image" "nginx" {
    name = "nginx:latest"
    keep_locally = false
}

resource "docker_container" "nginx" {
    image = docker_image.nginx.latest
    name = "nginxtutorial"
    ports {
        internal = 80
        external = 8080
    }
    upload {
        source = "${abspath(path.root)}/files/index.html"
        file = "/usr/share/nginx/html/index.html"
    }
}
 

Terraform will perform the following actions:

# docker_container.nginx will be created

Plan: 1 to add, 0 to change, 0 to destroy.

# What does the command terraform destroy do?

The terraform destroy command is used to destroy the Terraform-managed infrastructure. Decommissions all resources that are managed by Terraform recorded in the state file.

# How do you preview the behavior of the command terraform destroy?

terraform plan -destroy

# What are implicit and explicit dependencies?

Implicit dependency:
By studying the resource attributes used in interpolation expressions, Terraform can automatically infer when one resource depends on another.

Terraform uses this dependency information to determine the correct order in which to create the different resources.

Implicit dependencies via interpolation expressions are the primary way to inform Terraform about these relationships, and should be used whenever possible.


// Example
module "azurerm_app_service" {
  source = "./modules/azurerm/azurerm_app_service"

  resource_group_name = module.azurerm_resource_group.name
  location            = module.azurerm_resource_group.location
  app_service_plan_id = module.azurerm_app_service_plan.id
  
  # ...
}

Explicit dependency:
Sometimes there are dependencies between resources that are not visible to Terraform. The depends_on argument is accepted by any resource and accepts a list of resources to create explicit dependencies for.


// Example
module "azurerm_app_service" {
  source = "./modules/azurerm/azurerm_app_service"
 
  # ...
  
  depends_on = [azurerm_storage_account.example]
}

// This resource is explicitly dependant on the azurerm_storage_account resource